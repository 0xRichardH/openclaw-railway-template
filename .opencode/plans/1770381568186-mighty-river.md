# Plan: Fix Tailscale Proxy for Interactive Shells

## Problem
The proxy env vars in `/etc/profile.d/tailscale-proxy.sh` are not being sourced by Railway SSH because it spawns a **non-login shell**. `/etc/profile.d/` is only sourced by login shells.

## Solution
Write proxy env vars to `/etc/bash.bashrc` instead, which is sourced by all interactive bash shells (including non-login shells like Railway SSH).

## Changes

### Update `docker/entrypoint.sh`

Change from writing to `/etc/profile.d/tailscale-proxy.sh` to appending to `/etc/bash.bashrc`:

```bash
# Before:
if [ ! -f /etc/profile.d/tailscale-proxy.sh ]; then
    cat <<'EOF' > /etc/profile.d/tailscale-proxy.sh
export HTTP_PROXY="http://localhost:1056"
export HTTPS_PROXY="http://localhost:1056"
export NO_PROXY="localhost,127.0.0.1"
EOF
fi

# After:
if ! grep -q "HTTP_PROXY" /etc/bash.bashrc 2>/dev/null; then
    cat <<'EOF' >> /etc/bash.bashrc

# Tailscale HTTP proxy for accessing other tailnet nodes
export HTTP_PROXY="http://localhost:1056"
export HTTPS_PROXY="http://localhost:1056"
export NO_PROXY="localhost,127.0.0.1"
EOF
fi
```

Key differences:
- Uses `/etc/bash.bashrc` (sourced by non-login interactive shells)
- Uses `>>` to append instead of `>` to overwrite
- Uses `grep -q` to check if already added (idempotent)

## Files to Modify
| File | Change |
|------|--------|
| `docker/entrypoint.sh` | Change target from `/etc/profile.d/` to `/etc/bash.bashrc` |

## Verification
1. Deploy to Railway
2. SSH via `railway ssh` or Tailscale SSH
3. Run `echo $HTTP_PROXY` â€” should output `http://localhost:1056`
4. Test: `curl -x $HTTP_PROXY http://other-node.tailnet.ts.net/`
